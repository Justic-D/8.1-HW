# Домашнее задание к занятию 12.7 "`Репликация и масштабирование. Часть 2`" - "`Яринский Д.А.`"

## Задание 1

Опишите основные преимущества использования масштабирования методами:

- Активный master-сервер и пассивный репликационный slave-сервер;
- Master-сервер и несколько slave-серверов;
- Активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD);
- SAN-кластер.

***Дайте ответ в свободной форме.***

## Ответ:

- Активный master-сервер и пассивный репликационный slave-сервер:

Я так понимаю с настройкой функционала slave имеется ввиду или (или круговая репликация), тогда настройка репликации MySQL в режиме мастер-мастер
подразумевает то, что в случае отказа одного из серверов - другие участники репликации прозрачно подхватят работу. 
Т.е. не нужно будет делать ручных шагов для перевода сервера роли Slave-сервера в Master.

Если же имеется ввиду привычный master-slave приемуществом является распределение нагрузки, уменьшается нагрузка на основной сервер т.е. есть вомзожность читать данные со слейва. И есть функция определенной безопастности.

- Master-сервер и несколько slave-серверов:

По своей сути повышенная отказоустойчивость где в случае падения мастера, другой переводим в мастер, второй остаётся работать в slave. Доступна более глубокая разгрузка master сервера.

- Активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD):

Упрощённо говоря это HA кластер с RAID1 - который может быть так же и сетевым. Всё работает на уровне ядра DRBD.
Есть ограничение в пропускной способности и размеру хранилища. Кушает чуть больше ресурсов на себя.
Есть возможность разделить хранилище в каждом из узлов, где зеркально мы отразим первую часть узла 1 на часть узла 2, часть узла 2 на 3 и далее по схеме пока какой- либо номер оконечного узла не сделает этого с узлом 1 - который завершить так называемый круг.
Таким образом, мы можем превратить кольцо Сетевого RAID в неопределённо большой и сверх отказоустойчивый, но в реалиях как говорят во многих чатах
DRBD изжил себя и не используется слишком сложно и есть ряд минусов. 

- SAN-кластер:

По сути своей NAS система.
Быстродействие и масштабируемость, центральное управление и резервирование данных без загрузки локальной сети и серверов.
Защита на уровне экземпляра через избыточность. Автоматический переход на другой ресурс в случае сбоя и многое другое.

---

## Задание 2

Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц:

    пользователи,
    книги,
    магазины (столбцы произвольно).

Опишите принципы построения системы и их разграничение или разбивку между базами данных.

***Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.***

## Ответ:

В определенный момент кол-во пользователей может быть больше чем книг, а книг быть больше чем пользователей, да и кол-во магазинов и данных по ним, достаточно много. Разделение этих данных является единственным верным решением. Далее схемы согласно заданию.

**Вертикальный Шардинг:** 
- Перенос каждой таблицы на отдельный сервер.

![](/img/vtr.png)

**Горизонтальный шардинг:**
- Предположим что Польльзователей у нас их 500, и разбили на 2 части
аутентификации и данных users;
- Books разделена на 2 сервера по названию книги от A-N и от O-Z;
- Store остался без изменений и вынесен на отдельный сервер.

![](/img/grz.png)

---